To start:

Create a list of UGC domains.

For each PAGE, run through all the LINKS that comprise that PAGE and calculated how many consist of UGC. Do the same for the Top Three results.

What this might look like in code:

Select all the PAGES that match a given location. INNER JOIN links onto the PAGES.

For each page, calculate a percentage of UGC in the full page, top 3, top 1 result.